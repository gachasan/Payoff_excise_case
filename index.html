<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏™‡∏¥‡∏ô‡∏ö‡∏ô‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• | ‡∏Å‡∏£‡∏°‡∏™‡∏£‡∏£‡∏û‡∏™‡∏≤‡∏°‡∏¥‡∏ï</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* --- Variables & Reset --- */
        :root {
            --excise-blue: #1a498a;
            --excise-gold: #EAB308;
            --excise-grey: #9CA3AF;
            --background: #F0F2F5;
            --text-main: #1F2937;
            --text-muted: #6B7280;
            --border: #E5E7EB;
            --radius: 16px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: 'Prompt', sans-serif;
            background-color: var(--background);
            color: var(--text-main);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }

        /* --- Background Pattern (‡∏•‡∏≤‡∏¢‡∏ô‡πâ‡∏≥‡πÇ‡∏•‡πÇ‡∏Å‡πâ) --- */
        body::before {
            content: "";
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1;
            background-image: url('https://upload.wikimedia.org/wikipedia/commons/3/37/Logo_of_the_Excise_Department.svg');
            background-repeat: repeat;
            background-size: 120px;
            opacity: 0.03; /* ‡∏à‡∏≤‡∏á‡∏•‡∏á‡∏≠‡∏µ‡∏Å‡∏ô‡∏¥‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏™‡∏ö‡∏≤‡∏¢‡∏ï‡∏≤ */
            filter: grayscale(100%);
        }

        /* --- Main Card Container --- */
        .container {
            width: 100%;
            max-width: 460px; /* ‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡∏Å‡∏£‡∏∞‡∏ä‡∏±‡∏ö‡∏Ç‡∏∂‡πâ‡∏ô */
            background: #FFFFFF;
            border-radius: var(--radius);
            box-shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.15);
            overflow: hidden;
            animation: fadeIn 0.6s cubic-bezier(0.22, 1, 0.36, 1);
        }

        /* --- Top Section: Logo Area (Clean White) --- */
        .logo-area {
            background: white;
            padding: 25px 0 15px;
            text-align: center;
            position: relative;
        }

        .logo-main {
            width: 100px; /* ‡∏Ç‡∏ô‡∏≤‡∏î‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏µ */
            height: auto;
            /* ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏£‡∏≠‡∏ö ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÅ‡∏•‡πâ‡∏ß */
            filter: drop-shadow(0 4px 6px rgba(0,0,0,0.08)); /* ‡πÄ‡∏á‡∏≤‡∏ö‡∏≤‡∏á‡πÜ ‡πÉ‡∏´‡πâ‡∏•‡∏≠‡∏¢‡∏≠‡∏≠‡∏Å‡∏°‡∏≤ */
        }

        /* --- Title Strip (The Power Bar) --- */
        /* ‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠‡πÑ‡∏Æ‡πÑ‡∏•‡∏ó‡πå‡∏ó‡∏µ‡πà‡∏û‡∏µ‡πà‡∏Ç‡∏≠: ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô 75% | ‡πÄ‡∏ó‡∏≤ 20% | ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á 5% */
        .title-strip {
            padding: 20px 24px;
            color: white;
            background: linear-gradient(
                105deg, 
                var(--excise-blue) 0%, 
                var(--excise-blue) 70%, 
                var(--excise-grey) 70%, 
                var(--excise-grey) 92%, 
                var(--excise-gold) 92%, 
                var(--excise-gold) 100%
            );
            position: relative;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .title-strip h1 {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 4px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2); /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏á‡∏≤‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡πÉ‡∏´‡πâ‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢‡∏ö‡∏ô‡∏ó‡∏∏‡∏Å‡∏™‡∏µ */
        }
        .title-strip p {
            font-size: 0.85rem;
            opacity: 0.9;
            font-weight: 300;
        }

        /* --- Form Area --- */
        .search-box { padding: 30px 24px; }
        .form-group { margin-bottom: 20px; }
        
        .form-label {
            display: block;
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--text-main);
            margin-bottom: 8px;
        }

        .form-input {
            width: 100%;
            padding: 14px 16px;
            font-family: 'Prompt', sans-serif;
            font-size: 1rem;
            border: 1px solid #D1D5DB;
            border-radius: 10px;
            transition: all 0.2s;
            outline: none;
            background: #FAFAFA;
        }

        .form-input:focus {
            border-color: var(--excise-blue);
            background: white;
            box-shadow: 0 0 0 4px rgba(26, 73, 138, 0.1);
        }

        .btn-search {
            width: 100%;
            padding: 16px;
            background: var(--excise-blue);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.05rem;
            font-weight: 600;
            font-family: 'Prompt', sans-serif;
            cursor: pointer;
            transition: all 0.2s;
            margin-top: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            box-shadow: 0 4px 10px rgba(26, 73, 138, 0.3);
        }

        .btn-search:hover { 
            background: #133a70; 
            transform: translateY(-2px); 
            box-shadow: 0 6px 15px rgba(26, 73, 138, 0.4); 
        }
        .btn-search:active { transform: translateY(0); }
        .btn-search:disabled { background: #9CA3AF; cursor: not-allowed; transform: none; box-shadow: none;}

        /* --- Result Area --- */
        .result-area {
            border-top: 1px solid var(--border);
            background: #F9FAFB;
            padding: 30px 24px;
            display: none;
        }

        .result-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
            border: 1px solid #f0f0f0;
            animation: slideUp 0.5s cubic-bezier(0.16, 1, 0.3, 1);
        }

        .result-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 14px;
            padding-bottom: 14px;
            border-bottom: 1px solid #f3f4f6;
        }
        .result-row:last-child { border-bottom: none; margin-bottom: 0; padding-bottom: 0; }

        .label { color: var(--text-muted); font-size: 0.9rem; }
        .value { font-weight: 500; font-size: 1.05rem; text-align: right; color: var(--text-main);}

        .status-badge {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 30px;
            font-size: 0.9rem;
            font-weight: 600;
            background: #eee;
            color: #333;
            margin-top: 8px;
        }

        .status-success { background: #D1FAE5; color: #065F46; }
        .status-pending { background: #DBEAFE; color: #1E40AF; }
        .status-process { background: #FEF3C7; color: #92400E; }

        .error-msg {
            color: #991B1B;
            text-align: center;
            padding: 20px;
            background: #FEF2F2;
            border-radius: 12px;
            font-size: 0.95rem;
            border: 1px solid #FECACA;
        }

        /* --- Utility --- */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes slideUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        
        .spinner {
            width: 22px; height: 22px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
            display: none;
        }
        @keyframes spin { to { transform: rotate(360deg); } }

    </style>
</head>
<body>

    <main class="container">
        <div class="logo-area">
            <img src="https://upload.wikimedia.org/wikipedia/commons/3/37/Logo_of_the_Excise_Department.svg" alt="‡∏ï‡∏£‡∏≤‡∏™‡∏±‡∏ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå‡∏Å‡∏£‡∏°‡∏™‡∏£‡∏£‡∏û‡∏™‡∏≤‡∏°‡∏¥‡∏ï" class="logo-main">
        </div>

        <header class="title-strip">
            <h1>‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏™‡∏¥‡∏ô‡∏ö‡∏ô‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</h1>
            <p>‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Real-time</p>
        </header>

        <section class="search-box">
            <form id="searchForm">
                <div class="form-group">
                    <label for="caseNumber" class="form-label">‡πÄ‡∏•‡∏Ç‡∏Ñ‡∏î‡∏µ (Case No.)</label>
                    <input type="number" id="caseNumber" class="form-input" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏•‡∏Ç‡∏Ñ‡∏î‡∏µ ‡πÄ‡∏ä‡πà‡∏ô 1, 12" required>
                </div>
                <div class="form-group">
                    <label for="caseYear" class="form-label">‡∏õ‡∏µ ‡∏û.‡∏®. ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏î‡∏µ</label>
                    <input type="number" id="caseYear" class="form-input" placeholder="‡πÄ‡∏ä‡πà‡∏ô 2568" value="2568" required>
                </div>
                <button type="submit" class="btn-search" id="searchBtn">
                    <div class="spinner" id="spinner"></div>
                    <span>‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span>
                </button>
            </form>
        </section>

        <section id="resultArea" class="result-area">
            </section>
    </main>

    <script>
        // --- Config & Logic ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏° ‡πÄ‡∏õ‡πä‡∏∞‡πÜ ‡πÅ‡∏ï‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô URL API ‡πÉ‡∏´‡πâ‡πÅ‡∏•‡πâ‡∏ß ---
        const SHEET_ID = '1ZZqzLMXte_14iYxdHhYeLz3aqqieBwhk8ycKgCoPAYA';
        const SHEET_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json`;

        const searchForm = document.getElementById('searchForm');
        const resultArea = document.getElementById('resultArea');
        const searchBtn = document.getElementById('searchBtn');
        const spinner = document.getElementById('spinner');
        const btnText = searchBtn.querySelector('span');

        searchForm.addEventListener('submit', async function(e) {
            e.preventDefault();
            setLoadingState(true);

            const caseNoInput = document.getElementById('caseNumber').value.trim();
            const caseYearInput = document.getElementById('caseYear').value.trim();

            try {
                const response = await fetch(SHEET_URL);
                if (!response.ok) throw new Error("‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Sheet ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");
                
                const text = await response.text();
                const jsonText = text.substring(47).slice(0, -2);
                const json = JSON.parse(jsonText);
                const rows = json.table.rows;

                // Search Logic
                const foundRow = rows.find(row => {
                    const cNo = row.c[0]?.v;
                    const cYear = row.c[1]?.v;
                    return cNo == caseNoInput && cYear == caseYearInput;
                });

                renderResult(foundRow, caseNoInput, caseYearInput);

            } catch (error) {
                console.error(error);
                renderError(error.message);
            } finally {
                setLoadingState(false);
            }
        });

        function setLoadingState(isLoading) {
            searchBtn.disabled = isLoading;
            spinner.style.display = isLoading ? 'block' : 'none';
            btnText.textContent = isLoading ? '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•...' : '‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
            if(isLoading) resultArea.style.display = 'none';
        }

        function renderError(message) {
            resultArea.style.display = 'block';
            resultArea.innerHTML = `
                <div class="error-msg">
                    <strong>‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î</strong><br>
                    ${message}<br>
                    <small style="margin-top:8px; display:block;">‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï</small>
                </div>
            `;
        }

        function renderResult(row, inputNo, inputYear) {
            resultArea.style.display = 'block';
            
            if (!row) {
                resultArea.innerHTML = `
                    <div class="result-card" style="text-align:center; padding: 30px;">
                        <div style="font-size: 3rem; margin-bottom: 10px;">üìÑ</div>
                        <h3 style="color: var(--text-main); margin-bottom: 5px;">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h3>
                        <p style="color: var(--text-muted);">‡πÄ‡∏•‡∏Ç‡∏Ñ‡∏î‡∏µ ${inputNo}/${inputYear}</p>
                    </div>
                `;
                return;
            }

            const fine = row.c[2]?.v || 0;
            const reward = row.c[3]?.v || 0;
            const status = row.c[4]?.v ? String(row.c[4].v) : "‡∏£‡∏≠‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï";
            const caseNo = row.c[0]?.v;
            const year = row.c[1]?.v;

            let statusClass = 'status-process';
            if (status.includes("‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏¥‡∏ô‡∏ö‡∏ô‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏≠‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß")) statusClass = 'status-success';
            else if (status.includes("‡∏™‡πà‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£")) statusClass = 'status-pending';

            const fmt = new Intl.NumberFormat('th-TH', { minimumFractionDigits: 0, maximumFractionDigits: 2 });

            resultArea.innerHTML = `
                <div class="result-card">
                    <div class="result-row" style="align-items: center;">
                        <span class="label">‡πÄ‡∏•‡∏Ç‡∏Ñ‡∏î‡∏µ / ‡∏õ‡∏µ</span>
                        <span class="value" style="color: var(--excise-blue); font-size: 1.2rem; font-weight: 700;">
                            ${caseNo} / ${year}
                        </span>
                    </div>
                    <div class="result-row">
                        <span class="label">‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏±‡∏ö‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</span>
                        <span class="value">${fmt.format(fine)} ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="result-row" style="background: #F0F9FF; padding: 12px; border-radius: 8px; border: 1px solid #BAE6FD;">
                        <span class="label" style="color: #0369A1; font-weight: 600;">‡∏¢‡∏≠‡∏î‡∏™‡∏¥‡∏ô‡∏ö‡∏ô‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</span>
                        <span class="value" style="color: #0284C7; font-size: 1.2rem; font-weight: 700;">
                            ${fmt.format(reward)} ‡∏ö‡∏≤‡∏ó
                        </span>
                    </div>
                    <div style="margin-top: 20px; text-align: center;">
                        <span class="label" style="display:block; margin-bottom:6px;">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</span>
                        <div class="status-badge ${statusClass}">
                            ${status}
                        </div>
                    </div>
                </div>
            `;
        }
    </script>
</body>
</html>
